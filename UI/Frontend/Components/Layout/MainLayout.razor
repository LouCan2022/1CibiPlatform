@inherits LayoutComponentBase
@inject NavigationManager Navigation
@inject AuthService AuthService



<style>
    .mud-drawer {
        border-radius: 30px 30px 30px 30px !important;
    }

        .mud-drawer.mud-drawer-open {
            border-radius: 30px 30px 30px 30px !important;
        }

    .mud-appbar {
        border-radius: 30px 30px 30px 30px !important;
    }
</style>




@if (userId == "0")
{

    <MudThemeProvider Theme="@_myTheme" @bind-IsDarkMode="@_isDarkMode" />
    <MudPopoverProvider />
    <MudDialogProvider />
    <MudSnackbarProvider />



    <MudLayout>
        <!-- AppBar -->
        <MudAppBar Color="Color.Primary">
            <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@DrawerToggle" />
            <MudSpacer />
            <MudIconButton Icon="@(_isDarkMode ? Icons.Material.Filled.LightMode : Icons.Material.Filled.DarkMode)"
                           Color="Color.Inherit"
                           OnClick="@ToggleDarkMode" />
        </MudAppBar>
        
        <!-- Drawer -->
        <MudDrawer @bind-Open="_drawerOpen" Elevation="1">
            <MudDrawerHeader Style="display: flex; justify-content: center; align-items: center;">
                <MudPaper >
                    <MudIcon Icon="@Icons.Material.Filled.RepeatOneOn" Size="Size.Large" Style="color: blue;" />
                </MudPaper>
            </MudDrawerHeader>
     
            <MudNavMenu>
                <MudNavLink Href="/" Match="NavLinkMatch.All">Dashboard</MudNavLink>
                <MudNavGroup Title="Settings" Expanded="false">
                    <MudNavLink Href="/users" Match="NavLinkMatch.Prefix">Users</MudNavLink>
                    <MudNavLink Href="/security" Match="NavLinkMatch.Prefix">Security</MudNavLink>
                </MudNavGroup>
                <MudNavLink Href="/about" Match="NavLinkMatch.Prefix">About</MudNavLink>
            </MudNavMenu>
        </MudDrawer>
        
        <!-- Main content -->
        <MudMainContent>
            <MudPaper Class="pa-5 ma-5" Elevation="2">
    
                        @Body
              
            </MudPaper>
        </MudMainContent>
    </MudLayout>
}
@code {
    public string userId => AuthService.GetUserId();

    // Drawer state
    private bool _drawerOpen = true;

    // Dark/light toggle
    private bool _isDarkMode = false;

    // Theme definition
    private MudTheme _myTheme = new MudTheme()
    {
        PaletteLight = new PaletteLight()
        {
            Primary = "#667eea", 
            Secondary = "#764ba2", 
            Background = Colors.Gray.Lighten5,
            Surface = Colors.Shades.White,
            AppbarBackground = "#667eea",
            AppbarText = Colors.Shades.White,
            TextPrimary = Colors.Gray.Darken3
        },
        PaletteDark = new PaletteDark()
        {
            Primary = "#8b9dff", 
            Secondary = "#9d6bc7", 
            Background = Colors.Gray.Darken4,
            Surface = Colors.Gray.Darken3,
            AppbarBackground = "#5568d3", 
            AppbarText = Colors.Shades.White,
            TextPrimary = Colors.Shades.White
        },
        LayoutProperties = new LayoutProperties()
        {
            DefaultBorderRadius = "30px",
            DrawerWidthLeft = "260px",
            DrawerWidthRight = "260px",
            AppbarHeight = "64px"
        }
    };

    private void DrawerToggle() => _drawerOpen = !_drawerOpen;

    private void ToggleDarkMode() => _isDarkMode = !_isDarkMode;


    protected override void OnInitialized()
    {

            if (userId == "1")
            {
                Navigation.NavigateTo("/login", true);
            }
    }

}