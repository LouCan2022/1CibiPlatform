@page "/philsys"

@using MudBlazor

<MudPaper Class="p-6 mx-auto mt-6" MaxWidth="550px" MaxHeight="550px" Elevation="1" Style="padding: 25px; background-color: var(--mud-palette-surface);">
    <MudTabs Rounded="true" Centered="true" Elevation="0"
             @bind-ActivePanelIndex="_activeIndex"
             OnActivePanelIndexChanged="OnTabChanged">
        <MudTabs Rounded="true" Centered="true" Elevation="0" @bind-ActivePanelIndex="_activeIndex">
            <MudTabPanel Text="Personal Information" Class="@GetTabClass(0)" Style="text-transform:none; width: 200px; font-size: 15px;" />
            <MudTabPanel Text="PhilSys Card Number (PCN)" Class="@GetTabClass(1)" Style="text-transform:none; width: 200px; font-size: 15px;" />
        </MudTabs>

    </MudTabs>

    @if (_activeIndex == 0)
    {
        <!-- Personal Information form -->
        <MudForm @ref="personalForm" Class="mx-auto p-6 mt-0  philsys-card" >
            <MudGrid>
                <MudItem xs="8" sm="8">
                    <MudTextField @bind-Value="FirstName"
                                  Label="First Name"
                                  FullWidth="true"
                                  Required="true"
                                  RequiredError="First Name is required"
                                  For="@(() => FirstName)" />
                </MudItem>
                <MudItem xs="4" sm="4">
                    <MudSelect T="string"
                               Label="Suffix"
                               @bind-Value="Suffix"
                               FullWidth="true">
                        <MudSelectItem Value=@("N/A")>N/A</MudSelectItem> <MudSelectItem Value=@("Jr")>Jr.</MudSelectItem> <MudSelectItem Value=@("Sr")>Sr.</MudSelectItem> <MudSelectItem Value=@("II")>II</MudSelectItem> <MudSelectItem Value=@("III")>III</MudSelectItem>
                    </MudSelect>
                </MudItem>
            </MudGrid>

            <MudTextField @bind-Value="MiddleName"
                          Label="Middle Name (Optional)"
                          Required="true"
                          RequiredError="Middle Name is required"
                          FullWidth="true" />

            <MudTextField @bind-Value="LastName"
                          Label="Last Name"
                          Required="true"
                          FullWidth="true"
                          RequiredError="Last Name is required"
                          For="@(() => LastName)" />

            <MudTextField @bind-Value="BirthDate"
                          Label="Birth Date"
                          Required="true"
                          FullWidth="true"
                          RequiredError="Birth Date is required"
                          For="@(() => BirthDate)" />

            <MudButton Style="background:linear-gradient(90deg,#102247 0%,#2a77ae 50%,#68c0d6 100%) !important; color:white;"
                       FullWidth="true"
                       Class="mt-4"
                       OnClick="SubmitPersonalInfo">
                Next
            </MudButton>
        </MudForm>
    }
    else if (_activeIndex == 1)
    {
        <!-- PCN form -->
        <MudForm @ref="pcnForm" Class="mx-auto p-6 mt-0 philsys-card" MaxWidth="500px">
            <MudTextField @bind-Value="PCN"
                          Label="PhilSys Card Number (16-Digits)"
                          Required="true"
                          RequiredError="PhilSys Card Number is required"
                          Class="mb-4" />

            <MudButton Style="background:linear-gradient(90deg,#102247 0%,#2a77ae 50%,#68c0d6 100%) !important; color:white;"
                       FullWidth="true"
                       Class="mt-4"
                       OnClick="SubmitPCN">
                Next
            </MudButton>
        </MudForm>
    }

</MudPaper>

@code {
    private MudForm? personalForm;
    private MudForm? pcnForm;

    private string? FirstName { get; set; }
    private string? MiddleName { get; set; }
    private string? LastName { get; set; }
    private string? BirthDate { get; set; }
    private string? Suffix { get; set; } = "N/A";
    private string? PCN { get; set; } = string.Empty;

    private int _activeIndex = 0;

    private void OnTabChanged(int index)
    {
        _activeIndex = index;
    }

    private string GetTabClass(int index)
    {
        return _activeIndex == index
            ? "philsys-tab-pannel philsys-tab-pannel-active"
            : "philsys-tab-pannel philsys-tab-pannel-inactive";
    }

  
    private void SubmitPersonalInfo()
    {
        // handle PCN form submission
    }

    private void SubmitPCN()
    {
        // handle PCN form submission
    }
}
