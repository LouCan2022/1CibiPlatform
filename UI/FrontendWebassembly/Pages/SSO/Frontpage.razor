@layout SSOLayout
@page "/sso/frontpage"
@inject NavigationManager NavigationManager;
@inject ISSOService SSOService;
@inject IJSRuntime JSRuntime;
<style>
    .hover-card {
        transition: all 0.3s ease-in-out;
        box-shadow: var(--mud-elevation-3);
    }

    .hover-card:hover {
        transform: translateY(-5px) scale(1.03);
        box-shadow: var(--mud-elevation-10);
        filter: brightness(1.05);
    }

    .hover-card img {
        transition: transform 0.4s ease-in-out, filter 0.4s ease-in-out;
    }

    .hover-card:hover img {
        transform: scale(1.08);
        filter: brightness(1.1);
    }
</style>

@if (isLoading)
{
    <MudOverlay Visible="true" DarkBackground="true" Absolute="false">
        <MudStack AlignItems="AlignItems.Center" Spacing="4">
            <MudProgressCircular Color="Color.Primary" Size="Size.Large" Indeterminate="true" />
            <MudText Typo="Typo.h6" Color="Color.Primary">Verifying authentication...</MudText>
        </MudStack>
    </MudOverlay>
}
else
{
    <MudGrid GutterSize="3">
        <MudItem xs="12" sm="4">
            <MudCard Class="hover-card rounded-xl cursor-pointer"
                     @onclick="@(() => JSRuntime.InvokeVoidAsync("open", "/PI", "_blank"))">
                <MudCardMedia Image="https://picsum.photos/400/250?random=1" Height="200" />
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">PI</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="12" sm="4">
            <MudCard Class="hover-card rounded-xl cursor-pointer">
                <MudCardMedia Image="https://picsum.photos/400/250?random=2" Height="200" />
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">ICS</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="12" sm="4">
            <MudCard Class="hover-card rounded-xl cursor-pointer">
                <MudCardMedia Image="https://picsum.photos/400/250?random=3" Height="200" />
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">APP</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>
}

@code {
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        var isAuthenticated = await SSOService.IsUserAuthenticatedAsync();

        if (!isAuthenticated)
        {
            NavigationManager.NavigateTo("https://console.jumpcloud.com/login");

            return;
        }

        isLoading = false;
    }
}