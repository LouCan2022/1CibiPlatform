@using MudBlazor
@inject LocalStorageService LocalStorageService
@inherits LayoutComponentBase



<style>
    .mud-drawer {
        border-radius: 30px 30px 30px 30px !important;
    }

    .mud-drawer.mud-drawer-open {
        border-radius: 30px 30px 30px 30px !important;
    }

    .mud-appbar {
        border-radius: 15px !important;
    }

</style>


<MudThemeProvider Theme="@_myTheme" @bind-IsDarkMode="@_isDarkMode" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Style="@GetAppBarStyle()">            
        <MudImage Src="images/logo/cibi.png"
                      Alt="Cibi Logo"
                      Style="width: 125px; height:45px; filter: drop-shadow(0 0 1px white) drop-shadow(0 0 2px white) drop-shadow(0 0 3px white);" />
     
        <MudSpacer />
        <MudIconButton Icon="@(_isDarkMode? Icons.Material.Filled.LightMode : Icons.Material.Filled.DarkMode)"
                       Style="Color:Inherit"
                       OnClick="@ToggleDarkMode" />
    </MudAppBar>

    <MudMainContent>
        <MudPaper Class="pa-5 ma-4" Elevation="2">
            @Body
        </MudPaper>
    </MudMainContent>
</MudLayout>



@code {

    private bool _drawerOpen = true;
    private bool _isDarkMode = false;



    private MudTheme _myTheme = new MudTheme()
    {
        PaletteLight = new PaletteLight()
        {
            Primary = "#667eea",
            Secondary = "#764ba2",
            Background = Colors.Gray.Lighten5,
            Surface = Colors.Shades.White,
            AppbarBackground = "#667eea",
            AppbarText = Colors.Shades.White,
            TextPrimary = Colors.Gray.Darken3
        },
        PaletteDark = new PaletteDark()
        {
            Primary = "#8b9dff",
            Secondary = "#9d6bc7",
            Background = Colors.Gray.Darken4,
            Surface = Colors.Gray.Darken3,
            AppbarBackground = "#5568d3",
            AppbarText = Colors.Shades.White,
            TextPrimary = Colors.Shades.White
        },
        LayoutProperties = new LayoutProperties()
        {
            DefaultBorderRadius = "30px",
            AppbarHeight = "69px"
        }
    };

    private void DrawerToggle() => _drawerOpen = !_drawerOpen;
    private async Task ToggleDarkMode()
    {
        _isDarkMode = !_isDarkMode;
        await LocalStorageService.SetItemAsync("isDarkMode", _isDarkMode);
    }

    private string GetAppBarStyle()
    {
        return _isDarkMode
            ? "background: linear-gradient(90deg, #68c0d6 0%, #2a77ae 50%, #102247 100%) !important;"
            : "background: linear-gradient(90deg, #102247 0%, #2a77ae 50%, #68c0d6 100%) !important;";
    }
    private string GetMenuIconStyle()
    {
        return _isDarkMode
            ? "color: #102247;"
            : "color: white;";
    }
}